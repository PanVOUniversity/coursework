import React, { useEffect, useState } from 'react';
import { motion, useAnimation } from 'framer-motion';
import { useInView } from 'react-intersection-observer';
import { FaArrowDown, FaPlay, FaMapMarkerAlt } from 'react-icons/fa';
import './Hero.css';

const Hero = () => {
  const [currentImage, setCurrentImage] = useState(0);
  const controls = useAnimation();
  const [ref, inView] = useInView({
    threshold: 0.1,
    triggerOnce: false
  });

  const images = [
    'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80',
    'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80',
    'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80'
  ];

  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentImage((prev) => (prev + 1) % images.length);
    }, 5000);
    return () => clearInterval(interval);
  }, [images.length]);

  useEffect(() => {
    if (inView) {
      controls.start('visible');
    }
  }, [controls, inView]);

  const scrollToNext = () => {
    const featuresSection = document.querySelector('#features');
    if (featuresSection) {
      featuresSection.scrollIntoView({ behavior: 'smooth' });
    }
  };

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.3,
        delayChildren: 0.2
      }
    }
  };

  const itemVariants = {
    hidden: { y: 30, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.8,
        ease: "easeOut"
      }
    }
  };

  const imageVariants = {
    hidden: { scale: 1.1, opacity: 0 },
    visible: {
      scale: 1,
      opacity: 1,
      transition: {
        duration: 1.2,
        ease: "easeOut"
      }
    }
  };

  return (
    <section id="home" className="hero" ref={ref}>
      <div className="hero-background">
        <motion.div
          className="hero-image-container"
          variants={imageVariants}
          initial="hidden"
          animate={controls}
        >
          {images.map((image, index) => (
            <motion.img
              key={index}
              src={image}
              alt={`Moscow Skyline ${index + 1}`}
              className={`hero-image ${index === currentImage ? 'active' : ''}`}
              initial={{ opacity: 0 }}
              animate={{ opacity: index === currentImage ? 1 : 0 }}
              transition={{ duration: 1 }}
            />
          ))}
        </motion.div>
        
        <div className="hero-overlay" />
        
        <div className="floating-elements">
          <motion.div
            className="floating-element element-1"
            animate={{ y: [-10, 10, -10] }}
            transition={{ duration: 4, repeat: Infinity, ease: "easeInOut" }}
          />
          <motion.div
            className="floating-element element-2"
            animate={{ y: [10, -10, 10] }}
            transition={{ duration: 5, repeat: Infinity, ease: "easeInOut" }}
          />
          <motion.div
            className="floating-element element-3"
            animate={{ y: [-15, 15, -15] }}
            transition={{ duration: 6, repeat: Infinity, ease: "easeInOut" }}
          />
        </div>
      </div>

      <div className="container">
        <motion.div
          className="hero-content"
          variants={containerVariants}
          initial="hidden"
          animate={controls}
        >
          <motion.div className="hero-badge" variants={itemVariants}>
            <span>üèÜ –ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ</span>
          </motion.div>

          <motion.h1 className="hero-title" variants={itemVariants}>
            <span className="gradient-text">–≠–ª–∏—Ç–Ω–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</span>
            <br />
            –≤ —Å–µ—Ä–¥—Ü–µ –ú–æ—Å–∫–≤—ã
          </motion.h1>

          <motion.p className="hero-subtitle" variants={itemVariants}>
            –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–æ–º —Å—Ä–µ–¥–∏ –Ω–µ–±–æ—Å–∫—Ä–µ–±–æ–≤ –ú–æ—Å–∫–≤–∞-–°–∏—Ç–∏. 
            –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã, –ø–µ–Ω—Ç—Ö–∞—É—Å—ã –∏ –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –∫–ª–∞—Å—Å–∞ –ª—é–∫—Å 
            —Å –≤–∏–¥–æ–º –Ω–∞ –ö—Ä–∞—Å–Ω—É—é –ø–ª–æ—â–∞–¥—å.
          </motion.p>

          <motion.div className="hero-location" variants={itemVariants}>
            <FaMapMarkerAlt />
            <span>–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è</span>
          </motion.div>

          <motion.div className="hero-buttons" variants={itemVariants}>
            <motion.button
              className="btn btn-primary"
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              onClick={() => {
                const propertiesSection = document.querySelector('#properties');
                if (propertiesSection) {
                  propertiesSection.scrollIntoView({ behavior: 'smooth' });
                }
              }}
            >
              –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—ä–µ–∫—Ç—ã
            </motion.button>
            
            <motion.button
              className="btn btn-secondary"
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              onClick={() => {
                const contactSection = document.querySelector('#contact');
                if (contactSection) {
                  contactSection.scrollIntoView({ behavior: 'smooth' });
                }
              }}
            >
              <FaPlay className="btn-icon" />
              –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
            </motion.button>
          </motion.div>

          <motion.div className="hero-stats" variants={itemVariants}>
            <div className="stat-item">
              <div className="stat-number">300+</div>
              <div className="stat-label">–£—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</div>
            </div>
            <div className="stat-item">
              <div className="stat-number">12</div>
              <div className="stat-label">–õ–µ—Ç –æ–ø—ã—Ç–∞</div>
            </div>
            <div className="stat-item">
              <div className="stat-number">95%</div>
              <div className="stat-label">–î–æ–≤–æ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
            </div>
          </motion.div>
        </motion.div>
      </div>

      <motion.button
        className="scroll-indicator"
        onClick={scrollToNext}
        animate={{ y: [0, 10, 0] }}
        transition={{ duration: 2, repeat: Infinity }}
        whileHover={{ scale: 1.1 }}
      >
        <FaArrowDown />
        <span>–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑</span>
      </motion.button>
    </section>
  );
};

export default Hero;
